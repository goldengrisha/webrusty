<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <title>hello-wasm example</title>
</head>

<body>
    <form id="input-form">
        <label for="message">Enter Message:</label>
        <input type="text" id="message" name="message"><br><br>
        <input type="submit" value="Send">
    </form>
    <div id="messages"></div>
    <script type="module">
        import init, { greet, ws_ping } from "./pkg/webrusty.js";
        init().then(() => {
            const webSocketAddress = 'ws://localhost:443/';
            const webSocket = new WebSocket(webSocketAddress);
            webSocket.onmessage = (event) => {
                console.log(event)
                document.getElementById('messages').innerHTML +=
                    'Message from server: ' + event.data + "<br>";
            };
            webSocket.addEventListener("open", () => {
                console.log("We are connected");
            });
            function sendMessage(event) {
                var inputMessage = document.getElementById('message')
                ws_ping(webSocketAddress, inputMessage.value);
                inputMessage.value = ""
                event.preventDefault();
            }
            document.getElementById('input-form').addEventListener('submit', sendMessage);
        });
    </script>
</body>

</html>